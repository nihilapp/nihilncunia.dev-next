---
alwaysApply: true
---

# React & Next.js 프로젝트 규칙

---

## 컴포넌트 작성 규칙

- 페이지 컴포넌트와 일반 컴포넌트의 작성 시 다음의 템플릿 '/file-template/component_example.md' 을 참고한다.
- 컴포넌트 디자인 시 'shadcn' 컴포넌트를 사용한다. 해당 컴포넌트들은 '/app/(common)/\_components/ui'에 위치한다.
- 버튼은 'Button', 링크 버튼은 'LinkButton'을 사용한다. 모두 '/app/(common)/\_components/ui'에 있다.
- \_components나 \_layouts 폴더에는 반드시 'index.ts'를 만들고, 'export { 컴포넌트 } from ...' 형식으로 export 한다.
- page.tsx에서는 반드시 export default를 사용한다.
- 임포트 시 '@'는 'app' 폴더를 의미한다.
- 로직 작성 시 가독성을 위해 공백 라인을 적극적으로 활용한다.
- 공통 컴포넌트는 '/app/(common)/\_components'에 생성하고, index.ts에 export 한다.
- shadcn이 아닌 직접 작성 컴포넌트는 반드시 'class-variance-authority'를 사용한다.
- 데이터 존재 여부 확인 변수는 'find'로 시작해야 한다.
- page.tsx에는 'use client'를 사용하지 않는다(서버 컴포넌트 유지).
- page.tsx에는 반드시 metadata를 작성한다. (setMeta 함수는 'app/\_libs'에 위치) title, url 을 필수로 기재한다.
- 동적 페이지의 metadata는 generateMetadata 함수를 사용한다.
- page.tsx에서 파라미터는 'params' 변수명으로 받고, Promise 타입을 사용한다.
- 페이지 컴포넌트는 별도 파일로 만들고, cva 구조를 유지한다.
- 폼 관련 함수명은 onClick, onChange 등 수식어를 붙인다.
- 직접 작성한 아이콘은 '/app/\_icons'에 위치한다.

## 폼 컴포넌트 구조

- 폼 로직이 있는 컴포넌트는 별도의 클라이언트 컴포넌트로 분리한다.
- page.tsx는 서버 컴포넌트로 유지하고, 실제 폼 렌더링은 별도 컴포넌트에서 처리한다.
- 폼 컴포넌트는 `_components` 폴더에 위치하고, index.ts에서 export한다.
- 폼 컴포넌트는 Props 인터페이스를 정의하고, className과 기타 HTML 속성을 받을 수 있도록 한다.

### 폼 컴포넌트 예시

```typescript
// page.tsx (서버 컴포넌트)
import { SignInForm } from "./_components";
import { setMeta } from "@/_libs";

export const metadata = setMeta({
  title: "로그인",
  url: "/auth/signin",
});

export default function SignInPage() {
  return <SignInForm />;
}

// _components/SignInForm.tsx (클라이언트 컴포넌트)
("use client");

interface Props extends React.FormHTMLAttributes<HTMLFormElement> {
  className?: string;
}

export function SignInForm({ className, ...props }: Props) {
  // 폼 로직 구현
}
```

## 서비스 레이어 구조

- 데이터베이스 관련 로직은 각 엔티티의 service 파일에 위치한다.
- service 파일은 `@/_entities/[entity명]/[entity명].service.ts` 형태로 작성한다.
- Prisma 클라이언트는 `@/_libs/tools/prisma.tools`에서 PrismaHelper.client로 접근한다.
- API 라우트에서는 service 파일을 직접 import하여 사용한다.

### 서비스 파일 예시

```typescript
// auth.service.ts
import { PrismaHelper } from "@/_libs/tools/prisma.tools";

export class AuthService {
  static async signIn(signInData: SignInData) {
    const user = await PrismaHelper.client.user.findUnique({
      where: { email: signInData.email },
    });
    // 비즈니스 로직 구현
  }
}

// route.ts
import { AuthService } from "@/_entities/auth/auth.service";

export async function POST(request: NextRequest) {
  const result = await AuthService.signIn(signInData);
  // 응답 처리
}
```

---

## 기타 Next.js/React 개발 규칙

- 폴더 구조는 app/(common), app/(auth), app/(admin) 등 라우트 그룹을 사용한다.
- 공통 컴포넌트, 도메인별 \_entities, \_libs, \_icons 등 폴더 구조를 따른다.
- 스타일링은 TailwindCSS, Styled Components, shadcn/ui, class-variance-authority를 조합해 사용한다.
- 반응형 디자인을 기본으로 고려한다.
- SSR/CSR 구분에 유의하며, 서버 컴포넌트와 클라이언트 컴포넌트 역할을 명확히 한다.

---

## 파일 구조 규칙

- 각 엔티티는 다음과 같은 구조를 가진다:

  ```
  _entities/[entity명]/
  ├── index.ts
  ├── [entity명].api.ts
  ├── [entity명].service.ts
  ├── [entity명].store.ts
  ├── [entity명].keys.ts
  ├── [entity명].types.ts
  ├── [entity명].form-model.ts
  └── hooks/
      ├── index.ts
      └── use[Action][Entity].ts
  ```

- export 규칙:
  - `export { 컴포넌트 } from ...` 형식 사용
  - `export * from ...` 금지
  - 명시적으로 export할 항목들을 명확히 표시

---

> 이 규칙은 리액트/넥스트 기반 프로젝트의 일관성과 생산성, 유지보수성을 높이기 위한 가이드입니다.
